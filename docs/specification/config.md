# Config specification

Go to section:

* [Config](#config)
* [Config yaml](#config-yaml)
* [Meta yaml](#meta-yaml)

# Config

* In the `blueoil/cmd/train.py`, It needs `training` column config parameter.
* Other `cmd` scripts such as `blueoil/cmd/predict.py` needs `inference` config parameter.
* For exporting to Blueoil and Delta-Lite and demo app, the `export` config parameter needs.


## Contents

|config name|type|value|usage|training|inference|export|
|---|---|---|---|---|---|---|
|IS_DEBUG|boolean|True, False|Set True to use debug mode. It will summary some histograms, use small dataset and step size.|○|○||
|DATA_FORMAT|string|'NCHW', 'NHWC'|Set the data format. Case sensitive. If not set, default is 'NHWC'.|○|○|○|
|TASK|Enum or string|'IMAGE.CLASSIFICATION', 'IMAGE.OBJECT_DETECTION', 'IMAGE.SEMANTIC_SEGMENTATION'|Set the task type.|○|○|○|
|NETWORK_CLASS|class|SimpleNet, etc.|Class name of networks under networks folder. Should import first.|○|○||
|DATASET_CLASS|class|Cifar10, etc.|Class name of datasets under datasets folder. Should import first.|○|○||
|IMAGE_SIZE|tuple(int, int)|[32, 32]|Image size. (height, width)|○|○|○|
|BATCH_SIZE|int|16|Batch size. Currently, dynamic batch size is not supported. If you train with this batch size, you should test with same value.|○|○||
|CLASSES|list [string,...]|["apple", "orange", ..]|List of class name. Normally same to DATASEL_CLASS.classes.|○|○|○|
|MAX_EPOCHS|int|200|Max epochs. Require `MAX_EPOCHS` or `MAX_STEPS` when training.|○|||
|MAX_STEPS|int|10000000|Max steps. Require `MAX_EPOCHS` or `MAX_STEPS` when training.|○|||
|SAVE_CHECKPOINT_STEPS|int|1000|Per steps to save.|○|||
|KEEP_CHECKPOINT_MAX|int|1000|Maximum number of recent checkpoints to keep|○|||
|TEST_STEPS|int|100|Per steps to test.|○|||
|SUMMARISE_STEPS|int|100|Per steps to summarise.|○|||
|IS_PRETRAIN|boolean|True, False|If use pretrain model.|○|||
|PRETRAIN_VARS|list [string,...]|['conv1/kernel:', 'conv1/bias:', ...]|Vars to restore. It is needed when `IS_PRETRAIN` flag is `True`||||
|PRETRAIN_DIR|string|'saved/lmnet/checkpoints'|Pretrain checkpoints folder. It is needed when `IS_PRETRAIN` flag is `True`||||
|PRETRAIN_FILE|string|'save.ckpt-1'|Pretrain checkpoint file name. It is needed when `IS_PRETRAIN` flag is `True`||||
|PRE_PROCESSOR|Sequence|Sequence([...])|Sequence of pre-processors.|○|○|○|
|POST_PROCESSOR|Sequence|Sequence([...])|Sequence of post-processors.|○|○|○|
|NETWORK.OPTIMIZER_CLASS|class|tf.train.AdamOptimizer|Class of optimizer.|○|||
|NETWORK.OPTIMIZER_KWARGS|dict|{"learning_rate": 0.00005, "epsilon": 1e-4}|kwargs of optimizer.|○|||
|NETWORK.IMAGE_SIZE|list [int, int]|IMAGE_SIZE|Image size for network. Normally same to IMAGE_SIZE.|○|○||
|NETWORK.BATCH_SIZE|int|BATCH_SIZE|Batch size for network. Normally same to BATCH_SIZE.|○|○||
|NETWORK.DATA_FORMAT|string|DATA_FORMAT|Data format. Normally same to DATA_FORMAT.|○|○||
|DATASET.BATCH_SIZE|int|BATCH_SIZE|Batch size for dataset. Normally same to BATCH_SIZE.|○|||
|DATASET.PRE_PROCESSOR|Sequence|Sequence([...])|Sequence of pre-processors. Normally same to PRE_PROCESSOR.|○|||
|DATASET.AUGMENTOR|Sequence|Sequence([...])|Sequence of augmentors.|○|||
|DATASET.DATA_FORMAT|string|DATA_FORMAT|Data format. Normally same to DATA_FORMAT.|○|||
|||||||

# Config yaml
Config yaml file has following Unstandard YAML [pyyaml](https://pyyaml.org/) defined tags:

|tag|arg|python type|
|---|---|---|
|`!!python/name:`|module.cls|module.cls definition|
|`!!python/object:`|module.cls|module.cls instance|

You should remove these tags before using without python (pyyaml).
i.e. [classification.yaml](https://github.com/blue-oil/blueoil/blob/master/blueoil/configs/example/classification.yaml)

# Meta yaml
The meta yaml file is created from config python file, that is only include `export` column parameter.
For application, the exported meta yaml file has following standard yaml, it means it is not include `!!python...` generated by pyyaml.

i.e. [classification_meta.yaml](https://github.com/blue-oil/blueoil/blob/master/blueoil/configs/example/classification_meta.yaml)
